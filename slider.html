<!DOCTYPE html>
<meta charset="utf-8">
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.js'></script>
  <script src="https://d3js.org/d3.v5.min.js"></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.css' rel='stylesheet' />
<script type="text/javascript" src="map.js"></script>
<script type="text/javascript" src="maplayers.js"></script>
<style>

.map_class{
  width:100%;
  height: 70vh;
}
  body { margin:0; padding:0; }
  #map { top:0; bottom:0;width:100%; }
/*  map up*/
.ticks {
  font: 10px sans-serif;
}

.track,
.track-inset,
.track-overlay {
  stroke-linecap: round;
}

.track {
  stroke: #000;
  stroke-opacity: 0.3;
  stroke-width: 10px;
}

.track-inset {
  stroke: #ddd;
  stroke-width: 8px;
}

.track-overlay {
  pointer-events: stroke;
  stroke-width: 50px;
  stroke: transparent;
  cursor: crosshair;
}

.handle {
  fill: #fff;
  stroke: #000;
  stroke-opacity: 0.5;
  stroke-width: 1.25px;
}

</style>
<div id='map' class="map_class"></div>
<button onclick="slidetransition()"><strong>PLAY</strong></button>
<svg width="960" height="100"></svg>

<script src="//d3js.org/d3.v4.min.js"></script>
<script>

var svg = d3.select("svg"),
    margin = {right: 50, left: 50},
    width = +svg.attr("width") - margin.left - margin.right,
    height = +svg.attr("height");

var x = d3.scaleLinear()
    .domain([1228, 1826])
    .range([0, width])
    .clamp(true);

var slider = svg.append("g")
    .attr("class", "slider")
    .attr("transform", "translate(" + margin.left + "," + height / 2 + ")");

slider.append("line")
    .attr("class", "track")
    .attr("x1", x.range()[0])
    .attr("x2", x.range()[1])
  .select(function() { return this.parentNode.appendChild(this.cloneNode(true)); })
    .attr("class", "track-inset")
  .select(function() { return this.parentNode.appendChild(this.cloneNode(true)); })
    .attr("class", "track-overlay")
    .call(d3.drag()
        .on("start.interrupt", function() { slider.interrupt(); })
        .on("start drag", function() { hue(x.invert(d3.event.x)); }));

slider.insert("g", ".track-overlay")
    .attr("class", "ticks")
    .attr("transform", "translate(0," + 18 + ")")
  .selectAll("text")
  .data(x.ticks(10))
  .enter().append("text")
    .attr("x", x)
    .attr("text-anchor", "middle")
    .text(function(d) { return d; });

var handle = slider.insert("circle", ".track-overlay")
    .attr("class", "handle")
    .attr("r", 9);
function slidetransition()
{slider.transition() // Gratuitous intro!
    .duration(20000)
    .tween("hue", function() {
      var i = d3.interpolate(1228, 1826);
      return function(t) { hue(i(t)); };
    });
}
function hue(h) {
  handle.attr("cx", x(h));
  check(h);
}


function check(h)
{
// var newy=  year_check(h);
  // console.log(h+":"+newy);
  var index=year_check(h);
  transition(index);
}


function year_check(year)
{
  if(year<1827)
  {
      {if(year<1604){
          if(year<1552)
              {
                  if(year<1497)
                  {
                      if(year<1332)
                      {
                        return 1;
                      }
                  return 2;
                  }
                return 3;
              }
          return 4;}
      return 5;}
  }
}
////////mappp


mapboxgl.accessToken = 'pk.eyJ1Ijoic3Vwcml5YWR1dHRhIiwiYSI6ImNqbGYwZmRmbDBwZ2MzcG10MzMzdGg5YmoifQ.ZNvHvzDM6ojY36bVdqVorQ';
const map = new mapboxgl.Map({
container: 'map',
style: 'mapbox://styles/mapbox/light-v9',
boxZoom:false,
scrollZoom:false,
center: [93.994064, 26.356598],
zoom: 6.76,
maxZoom:7.76,
minZoom:5.6,
});









// console.log(layer.source.data.geometry.coordinates);


map.on('load', function () {

  map.addLayer(layer1);
  map.addLayer(layer2);
  map.addLayer(layer3);
  map.addLayer(layer4);
  map.addLayer(layer5);
  map.addLayer(layer6);
  map.addLayer(layer7);
  map.addLayer(layer8);
  map.addLayer(layer9);
});

function change()
{


transition(1);
window.setTimeout(console.log("default"),1000);
// window.setTimeout(
transition(2);
//,5000);
window.setTimeout(console.log("default"),1000);
// window.setTimeout(transition(3),10000);
// window.setTimeout(console.log("default"),1000);
// window.setTimeout(transition(4),4000);
// window.setTimeout(console.log("default"),1000);
// window.setTimeout(transition(5),5000);
// window.setTimeout(console.log("default"),1000);
// window.setTimeout(transition(6),6000);
// window.setTimeout(console.log("default"),1000);
// window.setTimeout(transition(7),7000);
// window.setTimeout(console.log("default"),1000);
// window.setTimeout(transition(8),8000);
// window.setTimeout(console.log("default"),1000);
// window.setTimeout(transition(9),9000);

// transition(2);
// transition(3);
// transition(4);
// transition(5);
// transition(6);
// transition(7);
// transition(8);
// transition(9);

}

function transition(index)
{
// var index=8;
for(var i=1;i<=9;i++)
{

  map.setPaintProperty("maine"+i,"fill-opacity",0);
}
map.setPaintProperty("maine"+index,"fill-opacity",0.5);


}
</script>
